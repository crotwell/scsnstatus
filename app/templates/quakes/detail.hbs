

<LeafletMap @lat={{model.center.latitude}} @lng={{model.center.longitude}} @zoom={{7}} @class="quakemap" @scrollWheelZoom={{false}}>
  <TileLayer @url="https://server.arcgisonline.com/ArcGIS/rest/services/Ocean_Basemap/MapServer/tile/{z}/{y}/{x}" />

  {{#each model.activeStations as |s|}}
    <MarkerLayer @lat={{s.latitude}} @lng={{s.longitude}} @icon=<DivIcon @className="stationMarker" /> @zIndexOffset={{100}}>
      <PopupLayer>
        <h3>Station: <LinkTo @route="stations.show" @model={{s.id}}>{{s.codes }} {{s.latitude}} {{s.longitude}}</LinkTo></h3>
      </PopupLayer>
    </MarkerLayer>
  {{/each}}

{{#let model.quake as |q|}}
  <CircleMarkerLayer @lat={{q.latitude}} @lng={{q.longitude}} @radius={{magnitude-to-radius q.prefMagnitude.mag 10}}>
    <PopupLayer>
      <h3>Event: <LinkTo @route="quakes.detail" @model={{q}}>{{moment-format q.time }} {{q.quake.prefMagnitude.magFormatted}} {{q.quake.prefMagnitude.magType}}</LinkTo></h3>
    </PopupLayer>
  </CircleMarkerLayer>
{{/let}}

  {{#each model.inactiveStations as |s|}}
    <MarkerLayer @lat={{s.latitude}} @lng={{s.longitude}} @icon=<DivIcon @className="inactiveStationMarker" /> @zIndexOffset={{-10}}>
      <PopupLayer>
        <h3>Station: <LinkTo @route="stations.show" @model={{s.id}}>{{s.codes }} {{s.latitude}} {{s.longitude}}</LinkTo></h3>
      </PopupLayer>
    </MarkerLayer>
  {{/each}}

</LeafletMap>


{{#let model.quake as |q|}}
<table>
  <tr>
    <th>EventId</th>
    <td>{{q.eventid}}</td>
  </tr>
  <tr>
    <th>Time</th>
    <td>{{moment-format q.time }}</td>
  </tr>
  <tr>
    <th>Latitude/Longitude</th>
    <td>{{q.latitude}}/{{q.longitude}}</td>
  </tr>
  <tr>
    <th>Depth</th>
    <td>{{q.depth}} m</td>
  </tr>
  <tr>
    <th>Magnitude</th>
    <td>{{q.prefMagnitude.mag}} {{q.prefMagnitude.type}}</td>
  </tr>
</table>
{{/let}}

<SeismogramDisplay @chanTRList={{model.chanTRList}} @quake={{model.quake}} @channelMap={{model.channelMap}} @overlayPicks={{true}}>
</SeismogramDisplay>

{{outlet}}
